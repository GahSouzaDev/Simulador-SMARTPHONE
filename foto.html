<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Foto</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body>
    <main>

        <header><!--Barra de notificações-->
            <i class="fas fa-wifi"></i>
            <button id="notificacao" onclick="notificacoes()"><!--Acionador da barra de notificações-->
                <strong>NOTIFICAÇÕES</strong>            
            </button>
            <div id="notifica"><!--Conteudo da barra de notificações-->
                   <div id="intnotifica">
                    <p></p><!--Exibe a data na barra de notificações--> 
                   <p id="data">Notificação</p>
                   </div>
            </div>
            <div id="hora"><!--Hora na barra de notificações-->
            </div>                        
        </header>

        <section id="photo-container">
            <img id="captured-photo" src="" alt="Foto Capturada">
            <button id="baixar" onclick="baixar()"><i class="fas fa-download"></i><span>Baixar</span></button>
            <script>
               document.addEventListener('DOMContentLoaded', () => {
    const photoElement = document.getElementById('captured-photo');

    // Recupera a imagem e o tipo de câmera do local storage
    const dataURL = localStorage.getItem('capturedPhoto');
    const facingMode = localStorage.getItem('facingMode'); // Armazena o modo da câmera (user ou environment)

    if (dataURL) {
        // Se a câmera foi frontal, inverta a imagem
        if (facingMode === 'user') {
            const img = new Image();
            img.src = dataURL;

            img.onload = () => {
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                canvas.width = img.width;
                canvas.height = img.height;

                context.translate(canvas.width, 0);
                context.scale(-1, 1);
                context.drawImage(img, 0, 0, canvas.width, canvas.height);

                photoElement.src = canvas.toDataURL('image/png');
            };
        } else {
            photoElement.src = dataURL;
        }
    } else {
        photoElement.alt = 'Nenhuma foto capturada';
    }
});

function baixar() {
    const dataURL = document.getElementById('captured-photo').src;
    if (dataURL) {
        const a = document.createElement('a');
        a.href = dataURL;
        a.download = 'foto-capturada.png';
        a.click();
    } else {
        console.error('Nenhuma foto encontrada para baixar.');
    }
}

            </script>
        </section>          

        <footer><!--Botões de navegação-->
            <div id="configura"><!--Conteudo da barra de notificações-->                
                <p id="data">Configurações</p>
                </div>
         </div>
            <button class="nav-button back-button" title="Voltar" onclick="voltar()"></button>
            <button class="nav-button home-button" title="Tela Inicial"
            onclick="inicio()"></button>
            <button class="nav-button history-button" title="Configuracao" onclick="configuracoes()"></button>
        </footer>

    </main>
<script src="script.js"></script>
</body>

</html>